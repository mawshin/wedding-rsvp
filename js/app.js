$(function(){function e(e){e.find(".required-field").attr("required","required")}function t(e){e.find(".required-field").removeAttr("required")}$('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="popover"]').popover(),$("#attending").on("change",function(){gtag("event","attending",{attending:$(this).val()}),"Yes"===$(this).val()?$(".section2").show():$(".section2").hide()}),$('[name^="additional_guest_diet_preference"]').on("change",function(){"Kid's meal"===$(this).val()||"Toddler (would not need to cater food)"===$(this).val()?($(this).parents(".form-group").next().next().show(),e($(this).parents(".form-group").next().next())):($(this).parents(".form-group").next().next().hide(),t($(this).parents(".form-group").next().next())),gtag("event","food",{main:$(this).val()})}),$('[name^="additional_guest"]').on("change",function(){if("0"!=$(this).val())switch($(".section3").show(),$(this).val()){case"1 additional guest":$(".guest1").show(),$(".guest2, .guest3, .guest4").hide(),e($(".guest1")),t($(".guest2")),t($(".guest3")),t($(".guest4"));break;case"2 additional guests":$(".guest1, .guest2").show(),$(".guest3, .guest4").hide(),e($(".guest1")),e($(".guest2")),t($(".guest3")),t($(".guest4"));break;case"3 additional guests":$(".guest1, .guest2, .guest3").show(),$(".guest4").hide(),e($(".guest1")),e($(".guest2")),e($(".guest3")),t($(".guest4"));break;case"4 additional guests":$(".guest1, .guest2, .guest3, .guest4").show(),e($(".guest1")),e($(".guest2")),e($(".guest3")),e($(".guest4"))}else $(".section3").hide();gtag("event","guest",{number:$(this).val()})}),$("#guest-form").on("change","select.error",function(e){""!=$(e.target).val()&&($(this).removeClass("error").addClass("valid"),$(this).next().hide())}),$("#form-submit").click(function(){var e=$("#guest-form");e.validate({errorPlacement:function(e,t){t.is(":radio")?t.parent().parent().parent().addClass("error").append(e):e.insertAfter(t)},focusInvalid:!0}),e.valid()?(grecaptcha.ready(function(){grecaptcha.execute("6LdlqBYaAAAAAGLUJCd0e0Ey-dfNBbnsfRz5_ZUE",{action:"submit"}).then(function(e){$("#guest-form").prepend('<input type="hidden" name="g-recaptcha-response" value="'+e+'">'),$.ajax({url:"//api.apispreadsheets.com/data/5636/",type:"post",data:$("#guest-form").serializeArray(),success:function(){alert("Your RSVP has been submitted! We look forward to meeting you on our big day!"),$("#guest-form")[0].reset()},error:function(){alert("There was an error, please try to submit the form later.")}})})}),gtag("event","submit",{submit:"success"})):gtag("event","submit",{submit:"fail"})})});